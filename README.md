# **URL SHORTENER**
---
## Описание
Сервис позволяющий преобразовать длинную ссылку в 8-ми символьный код

---

## Запуск
### Необходимые компоненты
* Docker
* docker-compose
* make

### Инструкция
1. Склонируйте репозиторий
```
https://github.com/amaterasutears/url-shortener.git
```
2. Перейдите в папку с проектом
```
cd url-shortener
```
3. Создайте в корне проекта файл .env (см. example.env)
4. Запустите проект
```
make dcu
```
---

## Использование
---
* Сокращение ссылки происходит по адресу ```http://localhost:8080/a?url=ссылка```

Пример: http://localhost:8080/a?url=https://www.google.com

Возвращается ответ с кодом 200 и 8-ми символьным кодом в теле ответа (/^[A-z0-9]{8}$/). При этом если мы добавляем одну и туже ссылку - код будет один и тот же


* Переход на оригинальную ссылку происходит по адресу ```http://localhost:8080/s/код```

Пример: http://localhost:8080/s/ac6bb669

Осуществляться 302-й редирект на исходную ссылку ```https://www.google.com```

---

## Стек
* Fiber: web-фреймворк
* MongoDB: постоянное хранилище данных
* Redis: временное хранилище данных (кэш)

---

## Комментарии
* Вспомогательная функция, находящаяся в пакете pkg/urlnormalizer является достаточно спорной и реализована не полностью из-за этого. Ее цель - принимать на вход адрес, и убирать оттуда лишние символы из адреса, а именно **www.** и **/** с конца пути. Слеш с конца пути убирать не всегда целесообразно, т.к. у всех серверов разные настройки и бывает такое что адрес со слешем в конце и без него обращаются к разным ресурсам.
* Unit-тесты написаны для главной функции всего приложения, которая сокращает адресс до 8 символьного кода, она находится в пакете internal/shortener, также тесты написаны для pkg/urlnormalizer.
* С помощью утилиты air сервер поднятый в Docker поддерживает горячую перезагрузку (только для упрощения процесса разработки)
* В приложении есть простенькая валидация с помощью пакета validator, валидация проверяет, действительность URL адреса, если будет передана строка отличная от URL адреса, приложение выкинет ошибку

---

## Ответ на вопрос тестового задания
Приложение должно горизонтально масштабироваться засчет шардирования MongoDB
Также приложение кэширует данные, что позволит снизить нагрузку на БД